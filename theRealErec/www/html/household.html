<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <title>더리얼마케팅 전자영수증</title>
    
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <link rel="stylesheet" media="all" href="../code/layout.css" />
    <link rel="stylesheet" media="all" href="../code/common.css" />

    <!-- main -->
	<script src="../code/jquery.bxslider.min.js"></script>
    <link href="../code/jquery.bxslider.css" rel="stylesheet" />
    
    <!-- scroll -->
	<script src="../code/fm.scrollator.jquery.js"></script>
	<link rel="stylesheet" href="../code/fm.scrollator.jquery.css" />
    
    <!-- Path to your custom app styles-->
    <link rel="stylesheet" href="../css/my-app.css">
    
    <!-- calendar-->
    <link rel="stylesheet" href="../code/calendar.css">
    <script src="../code/calendar.js"></script>
    
    
	<script src="../code/common.js"></script>
    
    
<style type="text/css">
.househ_box { background:#f2f2f2; border:1px solid #e5e5e5; margin-bottom:20px; padding:5px; border-radius:5px; }
.househ_inbox { background:#fff; border:1px solid #e5e5e5; padding:10px 5px; border-radius:5px; }
.househ_holl { padding:5px 5px 15px 5px; height:35px; }
.househ_holl div { width:6%; height:100%; margin:0 2%; border-radius:30px; border:1px solid #e5e5e5; float:left; background:#f2f2f2; }

.hh_txt01 { border:1px solid #ddd; background:#fff;  margin:0 5px 15px 5px; border-radius:5px; padding:10px 10px; font-size:1.4em; color:#333; }
.hh_txt01 span { font-size:0.7em; color:#999; padding-right:10px; }
.hh_half { background:#fff;  margin:0 5px 15px 5px; border-left:1px solid #ddd; border-top:1px solid #ddd; }
.hh_half li { float:left; border-right:1px solid #ddd; border-bottom:1px solid #ddd; width:50%; }
.hh_half li span { }
.hh_half li.hh_full { width:100%; }
.hh_half li div { font-size:0.7em; line-height:0.8em; color:#999; background:#f2f2f2; border-bottom:1px solid #e5e5e5; padding:5px 10px; line-height:0.9em; }
.hh_half li div.hh_hcon { font-size:1em; color:#333; background:#fff; line-height:1.4em; border-bottom:0px; }
.hh_copy { text-align:center; font-size:0.7em; }


.hh_table { border:1px solid #ddd; margin:0 5px 15px 5px;  }
.hh_table .hh_tabletitle { border-bottom:1px solid #ddd; background:#f2f2f2;}
.hh_table li { float:left; padding:5px 0; text-align:center; border-left:1px solid #ddd; color:#333; }
.hh_table li:first-child { border-left:0; }
.hh_table li.hh_mlat01 { width:20%; }
.hh_table li.hh_mlat02 { width:35%; }
.hh_table li.hh_mlat03 { width:20%; }
.hh_table li.hh_mlat04 { width:25%; text-align:right; padding-right:5px; }


.house_box { background:#fff; }
.house_now { text-align:center; font-size:1.5rem; color:#888; }
.house_nav { height:40px; margin:0 10px; }
.house_nav .house_leftcon { width:30%; float:left; text-align:left; }
.house_nav .house_rightcon { width:30%; float:right; text-align:right; }
.house_nav i{ font-style: normal; text-align: center; width: 2rem; height: 2rem; line-height: 2rem; top: 0; font-family:Tahoma, Geneva, sans-serif; color:#539bff; text-indent:-999;}
.house_nav i:before {  left:0; speak: none; font-style: normal; font-weight: normal; font-family: "icomoon"; -webkit-font-smoothing: antialiased; -webkit-text-stroke-width: 0.2px; font-size: 1.8rem; line-height: 2rem; text-align: center; width: 2rem; }
.house_nav i.prev:before {   content: ""; }
.house_nav i.next:before {   content: ""; }
</style>    
    
</head>

<body>



    <!-- Status bar overlay for fullscreen mode-->
    <div class="statusbar-overlay"></div>


    <!-- Panels overlay-->
    <div class="panel-overlay"></div>


    <div class="panel panel-left panel-reveal">
    
    	<div class="profile_box">
        	<div class="pf_photo" style="background:url(../common/profile.jpg) no-repeat center;"></div>
            
            <div class="pf_txt">
            	<h2>김종현</h2>
                <p>쿠폰 <span>0</span>개</p>
                <p>포인트 <span>200</span>p</p>
                
                <div class="alen_setting" onClick="location.href='setting.html'">
                <a href="#"><i class="icon icon-form-settings"></i></a>
                </div>
            </div>
            <hr>
        </div>
        
        <div class="left_menu">
        	<ul>
            	<li onClick="location.href='latest.html'">
                <div class="leftm_box leftm01"></div>
                <a href="#">최근사용내역</a>
                </li>
                
            	<li onClick="location.href='history.html'">
                <div class="leftm_box leftm02"></div>
                <a href="#">영수증확인</a>
                </li>
                
            	<li onClick="location.href='household.html'">
                <div class="leftm_box leftm03"></div>
                <a href="#">가계부</a>
                </li>
                
            	<li onClick="location.href='event.html'">
                <div class="leftm_box leftm04"></div>
                <a href="#">이벤트</a>
                </li>
                
            	<li onClick="location.href='notice.html'">
                <div class="leftm_box leftm05"></div>
                <a href="#">공지사항</a>
                </li>
                
            </ul>
        </div>

    </div>
    
    
    <div class="views">
		<div class="view view-main">
        
            <div class="navbar top_menu">
                <div data-page="index" class="navbar-inner">
                
                    <div class="left">
                    <a href="#" class="link icon-only open-panel"> <i class="icon icon-bars"></i></a>
                    </div>
                    <div class="center sliding alen_logo"><img src="../common/logo.png"></div>

                </div>
                
                <div data-page="house_detail" class="navbar-inner cached">
                <div class="left sliding"><a href="#" class="back link"> <i class="icon icon-back"></i><span>Back</span></a></div>
                <div class="center sliding">지출 내역</div>
                </div>
                
                
                <div data-page="agree01" class="navbar-inner cached">
                <div class="left sliding"><a href="#" class="back link"> <i class="icon icon-back"></i><span>Back</span></a></div>
                <div class="center sliding">개인정보 수집이용취급위탁 동의</div>
                </div>
                
                
                <div data-page="agree03" class="navbar-inner cached">
                <div class="left sliding"><a href="#" class="back link"> <i class="icon icon-back"></i><span>Back</span></a></div>
                <div class="center sliding">본인확인서비스 이용약관</div>
                </div>
                
                
            </div>
         
            
			

			<div class="pages navbar-through toolbar-through">
                <div data-page="index" class="page">
                    <div class="page-content">

					<div class="house_txt">
					김종현 고객님은 10.01부터 10.24일까지<br>
                    카드 3건, 현금 5건 총 8건 50,000원을 사용하셨습니다.
                    </div>
                    
                    <div class="house_graph">
                    </div>
					
                    <div id="calendar"></div>
                    
                    <div class="foot_info">
                    
                    	<div class="foot_box">
                        	<div class="foot_btn alen_outbox">
                            <a href="#agree03">이용약관</a>
                            </div>
                            
                        	<div class="foot_btn alen_outbox">
                            <a href="#agree01">개인정보 취급방침</a>
                            </div>
                            
                        	<div class="foot_btn alen_outbox">
                            <a href="#">고객센터</a>
                            </div>
                            
                            
                            <hr>
                        </div>
<p>
(주)이베이 코리아   |   대표이사 : 변광윤<br>
사업자등록번호 : 220-81-83676   |   통신판매업신고 강남 10630호<br>
서울시 강남구 테헤란로 152 (역삼동 강남파이낸스센터)<br>
이메일 :information@corp.auction.co.kr<br>
고객센터 :1588-0184(오전9시~오후6시,토요일/공휴일휴무<br>
</p>

<p class="copytxt">Copyrightⓒnoname Co,.All rights reserved</p>
                    </div>
                    
                    
                    </div>
                </div>
                
                <div data-page="house_detail" class="page cached">
                    <div class="page-content house_box">
                        <div class="content-block">
                        
                        <div class="house_now">11월 15일</div>
                        
                        <div class="house_nav">
                        	<div class="house_leftcon2">
                            <i class="prev2"></i> </div>
                            
                        	<div class="house_rightcon2">
                            <i class="next2"></i></div>
                            
                            <hr>
                        </div>
                        
						<div class="househ_box">
                        	<div class="househ_inbox">
                                
                                <div class="hh_half">
                                	<ul>
                                      <li class="hh_full"><div>오늘의 총 영수증 발급</div><div class="hh_hcon">4건 / 40,000원</div></li>
                                      <li><div>현금결제</div><div class="hh_hcon">1건 / 10,000원</div></li>
                                      <li><div>카드결제</div><div class="hh_hcon">3건 / 30,000원</div></li>
                                      <hr>
                                    </ul>
                                </div>
                                
                                <div class="hh_table">
                                	<ul class="hh_tabletitle">
                                      <li class="hh_mlat01">시간</li>
                                      <li class="hh_mlat02">업체명</li>
                                      <li class="hh_mlat03">현금/카드</li>
                                      <li class="hh_mlat04">금액</li>
                                      <hr>
                                    </ul>
                                    
                                	<ul>
                                      <li class="hh_mlat01">09:30</li>
                                      <li class="hh_mlat02">카페</li>
                                      <li class="hh_mlat03">신사동</li>
                                      <li class="hh_mlat04">10,000원</li>
                                      <hr>
                                    </ul>
                                    
                                	<ul>
                                      <li class="hh_mlat01">09:30</li>
                                      <li class="hh_mlat02">카페</li>
                                      <li class="hh_mlat03">신사동</li>
                                      <li class="hh_mlat04">10,000원</li>
                                      <hr>
                                    </ul>
                                    
                                	<ul>
                                      <li class="hh_mlat01">09:30</li>
                                      <li class="hh_mlat02">카페</li>
                                      <li class="hh_mlat03">신사동</li>
                                      <li class="hh_mlat04">10,000원</li>
                                      <hr>
                                    </ul>
                                    
                                </div>
 
                                
                            </div>
                        </div>

                        
                        
                        </div>
                    </div>
                </div>
                
                
                
                <div data-page="agree01" class="page cached">
                    <div class="page-content agree_acon">
                        <div class="content-block">
						<iframe src="agree01.html" frameborder="0" width="100%" height="100%"></iframe>
                        </div>
                    </div>
                </div>
                
                
                <div data-page="agree03" class="page cached">
                    <div class="page-content agree_acon">
                        <div class="content-block">
						<iframe src="agree03.html" frameborder="0" width="100%" height="100%"></iframe>
                        </div>
                    </div>
                </div>
                
			</div>
            
            
            
            

		</div>
    </div>
    
    
    
    

<script>
	var now = new Date();
	var year = now.getFullYear();
	var month = now.getMonth() + 1;
	var date = now.getDate();
	var request = new Request();
	var telNo = request.getParameter('telNo');
	var uuId = request.getParameter('uuId');

	var today = new Date();
	var dd = today.getDate();
	var mm = today.getMonth()+1;
	var yyyy = today.getFullYear();
	var month = today.getMonth()-1;
	if(dd<10) {
	    dd='0'+dd
	} 

	if(mm<10) {
	    mm='0'+mm
	} 	
	
	function replaceAll(content,before,after){
	    return content.split(before).join(after);
	}	
	
	$(document).ready(function(){
		commonUserData();

	    $.ajax({
	        type: "post",
	        url : commonIp()+"/theReal/receipt/houseHold.do",
	        /* dataType : "html", */
	        dataType:"json",
	        data: {
/*  	        	startDate : "20161001",
	        	endDate : "20161031",  */
  	        	startDate : yyyy+"0101",
	        	endDate : yyyy+"1231",
	        	eMail : telNo,
	        },
	        success: startGetB01CalDataSuc,
	        error: whenError
	    	});			
		
	 	$(document).on('click','.prev',function(){
/* 			alert("prev");
 			today = new Date(today.getFullYear(), (month), today.getDate());
			var startDate = new Date();
			var endDate   = new Date();
			startDate.setFullYear(today.getFullYear());
			endDate.setFullYear(today.getFullYear());
			startDate.setMonth((today.getMonth()+1));
			endDate.setMonth((today.getMonth()+2));
			month = today.getMonth();
			var startPrevYear = startDate.getFullYear();
			var startPrevMonth = startDate.getMonth();			
			alert(startPrevYear);
			alert(startPrevMonth);
		    $.ajax({
		        type: "post",
		        url : commonIp()+"/theReal/receipt/houseHold.do",
		        dataType:"json",
		        data: {
		        	startDate : startPrevYear+""+startPrevMonth+"01",
		        	endDate : startPrevYear+""+startPrevMonth+"31",
		        	eMail : telNo,
		        },
		        success: startGetB01CalDataSuc,
		        error: whenError
		    	});	 */	 		
		});
	 	
/* 	 	$(".dot").closest("a").click(function(){
	 		alert("11111");
	 	})
	 	
	 	$(document).on('click','.next',function(){
			alert("next");
		});
	 	
	 	
	 	$(document).on('click','.next',function(){
			alert("next");
		});
	 	
	 	$(document).on('click','.now',function(){
			alert("now11");
		}); */

	 	$(document).on('click','.calendar .days li',function(){
			console.log(this);	 		
			 var nowDay = $(this).attr('data-calendar-day');
			 $(".house_now").text(nowDay+" 영수증 발급내역");
			 console.log(nowDay);
			 nowDay = replaceAll(nowDay,"/","");
   		    $.ajax({
			        type: "post",
			        url : commonIp()+"/theReal/receipt/houseHoldDetail.do",
			        dataType:"json",
			        data: {
			        	startDate : nowDay,
			        	telNo : telNo,
			        },
			        success: houseHoldDetailDataSuc,
			        error: whenError
			    	}); 
	 		

		});

/* 	 	$(document).on('click','.dot',function(){
			alert("now22");
		}); */
        		
	})
	
	function houseHoldDetailDataSuc(resdata){

		var resultData = resdata.resultMap;
		console.log(resultData);
		var resultCnt = resultData.length;
		if(resultCnt > 0){
			$(".househ_box").empty();
			var cashCnt = resultData[0].CASH_CNT;
			var cardCnt =  resultData[0].CARD_CNT;
			var cashAm =  resultData[0].CASH_AM;
			var cardAm =  resultData[0].CARD_AM;
			var totalCnt = cashCnt+cardCnt;
			var totalAm = parseInt(replaceAll(cashAm,",",""))+parseInt(replaceAll(cardAm,",",""));
			var str = "";
			str += '<div class="househ_inbox">';
			str += '    <div class="hh_half">';
			str += '    	<ul>';
			str += '          <li class="hh_full"><div>오늘의 총 영수증 발급</div><div class="hh_hcon">'+totalCnt+'건 / '+numberWithCommas(totalAm)+'원</div></li>';
			str += '          <li><div>현금결제</div><div class="hh_hcon">'+cashCnt+'건 / '+cashAm+'원</div></li>';
			str += '          <li><div>카드결제</div><div class="hh_hcon">'+cardCnt+'건 / '+cardAm+'원</div></li>';
			str += '          <hr>';
			str += '        </ul>';
			str += '    </div>';
			str += '    <div class="hh_table">';
			str += '    	<ul class="hh_tabletitle">';
			str += '          <li class="hh_mlat01">시간</li>';
			str += '          <li class="hh_mlat02">업체명</li>';
			str += '          <li class="hh_mlat03">현금/카드</li>';
			str += '          <li class="hh_mlat04">금액</li>';
			str += '          <hr>';
			str += '        </ul>';		
			for(var i=0; i<resultCnt; i++){
				str += '<ul>';
				str += '  <li class="hh_mlat01">'+resultData[i].CNT_DATE.substring(5)+'</li>';
				str += '  <li class="hh_mlat02">'+resultData[i].SHOP_NAME+'</li>';
				if(isNull(resultData[i].CARD_ICOM)){
					str += '  <li class="hh_mlat03">현금</li>';
					str += '  <li class="hh_mlat04">'+numberWithCommas(resultData[i].CASH_AMT)+'원</li>';
				}else{
					str += '  <li class="hh_mlat03">'+resultData[i].CARD_ICOM+'</li>';
					str += '  <li class="hh_mlat04">'+numberWithCommas(resultData[i].CARD_AMT)+'원</li>';
				}
				str += '  <hr>';
				str += '</ul>';				
			}		
			/* for(var i=o; i<resultCnt; i++){
			} */
			str += '    </div>';
			str += '</div>';					
		}
	
		
		$(".househ_box").append(str);		
		
	}
	function startGetB01CalDataSuc(resdata){
		/* 		<div class="house_txt">
		김종현 고객님은 10.01부터 10.24일까지<br>
        카드 3건, 현금 5건 총 8건 50,000원을 사용하셨습니다.
        </div> */
        /* 카드 3건, 현금 5건 총 8건 50,000원을 사용하셨습니다. */
        /* $(".house_txt").text($(".pf_txt>h2").text()); */		
		var resultData = resdata.resultMap;
		console.log(resultData);
		var resultCnt = resultData.length;
		var data = new Array();
		for(var i=0; i<resultCnt; i++){
			var dtlGoodsObj = new Object();
            dtlGoodsObj.date = resultData[i].CNT_DATE;
            dtlGoodsObj.value = resultData[i].CONUT+"건";
            data.push(dtlGoodsObj);
		}
		//data = JSON.stringify(data);
		console.log(data);
		var data2 = [{
			date: '2016-11-11',
			value: '3건'
		}
		
		,{
			date: '2016-11-15',
			value: '2건'
		}
		,{
			'date': '2016-11-17',
			'value': '2건'
		}
		,{
			'date': '2016-11-18',
			'value': '2건'
		}
		
		];
		console.log(data);
		// inline
		var $ca = $('#calendar').calendar({
			// view: 'month',
			width: 100,
			height: 300,
			// startWeek: 0,
			// selectedRang: [new Date(), null],
			data: data,
			onSelected: function(view, date, data) {
				console.log('view:' + view)
				console.log('date:' + date)
				console.log('data:' + (data || 'cancel'));
			},
			viewChange: function(view, y, m) {
				console.log(view, y, m)
			}
		});		
		
		//[{"date":"2016-11-11","value":"3건"},{"date":"2016-11-11","value":"3건"},{"date":"2016-11-11","value":"3건"}]		
		
/* 		var data = [{
			date: '2016-11-11',
			value: '3건'
		}
		
		,{
			date: '2016-11-15',
			value: '2건'
		}
		,{
			'date': '2016-11-17',
			'value': '2건'
		}
		,{
			'date': '2016-11-18',
			'value': '2건'
		}
		
		];		 */
		

	};
	
	function whenError(){
		alert("ERROR");
	};	
	
</script>


<script type="text/javascript" src="../js/framework7.js"></script>

<script type="text/javascript" src="../js/my-app.js"></script>

<input value="activate scrollator" id="activate_scrollator4" type="button"  style="display:none;">
</body>
</html>
