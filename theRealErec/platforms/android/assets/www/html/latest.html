<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <title>더리얼마케팅 전자영수증</title>
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <link rel="stylesheet" media="all" href="../code/layout.css" />
    <link rel="stylesheet" media="all" href="../code/common.css" />

    <!-- main -->
	<script src="../code/jquery.bxslider.min.js"></script>
    <link href="../code/jquery.bxslider.css" rel="stylesheet" />
    
    <!-- tab -->
	<script type='text/javascript' src='../code/tabs.js'></script>

    <!-- scroll -->
	<script src="../code/fm.scrollator.jquery.js"></script>
	<link rel="stylesheet" href="../code/fm.scrollator.jquery.css" />
    
    <!-- Path to your custom app styles-->
    <link rel="stylesheet" href="../css/my-app.css">
    <link href="../css/monthpicker.css" rel="stylesheet" />
	<script src="../code/common.js"></script>
<!-- 	<script type="text/javascript" charset="utf-8" src="../cordova.js"></script> -->
<style type="text/css">
/* .on { color: blue; border: 1px solid blue; } */
.on { }
.list-block {display: none; }
.item-title.small-fonts{font-size: small;}


.alen_list_box2 { margin:0px 0px; background:none; border:0; }
.alen_list_box2 li { margin:0 10px 0 10px; }
.alen_list_combtnbox { height:35px; margin-bottom:5px; }
.alen_list_combtn { margin:3px 10px 3px 10px; padding:0 5px 0 5px; border:1px solid #539bff; color:#fff; /* font-size:1.5em; */ font-weight:400; text-align:center; line-height:50px; cursor:pointer; background:#539bff; -webkit-border-radius:10; -moz-border-radius:10; border-radius:10px; }
.albpad { padding:0px 0 0px 0; }

.alen_list_btn2 { margin:10px 10px 10px 10px; padding:0; border-radius:10px; background:#333; }
.alen_list_btn2item { width:20%; float:left;; text-align:center; color:#fff;}
.alen_list_btn2item .al_btn_txt { padding:10px 0; border-right:1px solid #666; }
.alen_list_btn2item .al_btn_txt.last { border-right:0; }

.alen_list_box2 label.label-radio input[type="radio"] ~ .item-inner { padding-right: 15px; text-align:center; }
.alen_list_box2 label.label-radio input[type="radio"] ~ .item-inner .item-title { margin:0 auto; }
.alen_list_box2 label.label-radio input[type="radio"]:checked ~ .item-inner { background: no-repeat center; background-position: 50% 3px; background-position: -webkit-calc(50% - 8px) 3px; background-position: calc(50% - 8px ) 3px; -webkit-background-size: 13px 10px; background-size: 13px 10px; 
background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2013%2010'%3E%3Cpolygon%20fill%3D'%23539bff'%20points%3D'11.6%2C0%204.4%2C7.2%201.4%2C4.2%200%2C5.6%204.4%2C10%204.4%2C10%204.4%2C10%2013%2C1.4%20'%2F%3E%3C%2Fsvg%3E");  }
.divPage{background: url(../common/divPage.png) no-repeat 0 0;background-position: 0% 0%; height: 30px;"}
.alen_radio_box2 { margin:10px; border:1px solid #e5e5e5; }
</style>
</head>

<body>



    <!-- Status bar overlay for fullscreen mode-->
    <div class="statusbar-overlay"></div>


    <!-- Panels overlay-->
    <div class="panel-overlay"></div>


    <div class="panel panel-left panel-reveal">
    
    	<div class="profile_box">
        	<!-- <div class="pf_photo" style="background:url(common/profile.jpg) no-repeat center;"></div> -->
            
            <div class="pf_txt">
            	<h2>김종현</h2>
                <p>쿠폰 <span>0</span>개</p>
                <p>포인트 <span>200</span>p</p>
            </div>
            <hr>
        </div>
        
        <div class="left_menu">
        </div>

    </div>
    
    <div class="views">
		<div class="view view-main">
        
            <div class="navbar top_menu">
                <div data-page="index" class="navbar-inner">
                
                    <div class="left">
                    <a href="#" class="link icon-only open-panel"> <i class="icon icon-bars"></i></a>
                    </div>
                    <div class="center sliding alen_logo" style="width: 65%"><img style="width: 65%;height: 50%;margin-left: 20%" src="../common/logo_01.png"></div>

                </div>
                
                <div data-page="receipt_details" class="navbar-inner cached">
                <div class="left sliding"><a href="#" class="back link"> <i class="icon icon-back"></i><span>Back</span></a></div>
                <div class="center sliding">영수증 상세 내역</div>
                </div>
                
                
                <div data-page="agree01" class="navbar-inner cached">
                <div class="left sliding"><a href="#" class="back link"> <i class="icon icon-back"></i><span>Back</span></a></div>
                <div class="center sliding">개인정보 수집이용취급위탁 동의</div>
                </div>
                
                
                <div data-page="agree03" class="navbar-inner cached">
                <div class="left sliding"><a href="#" class="back link"> <i class="icon icon-back"></i><span>Back</span></a></div>
                <div class="center sliding">본인확인서비스 이용약관</div>
                </div>
                
                <div data-page="detailSearch" class="navbar-inner cached">
                <div class="left sliding"><a href="#" class="back link"> <i class="icon icon-back"></i><span>Back</span></a></div>
                <div class="center sliding">상세조회</div>
                </div>
                
                
            </div>
            


			<div class="pages navbar-through toolbar-through">
                <div data-page="index" class="page">
                    <div class="page-content">
                    
                    <div class="history_title">
                        <div class="history_txt" >전자영수증 내역확인</div>
                        <div class="history_total divPage" id="totalAmount"></div>
                        <hr>
                    </div>                    
                    
 <!--                    <div class="history_btnbox">
                       
                        <div class="history_cate">
                            <div class="slide">
							<a href="#"><img src="../icon/car.png"></a>
                            <p>자동차/주유</p>
                            </div>
                            
                            <div class="slide">
							<a href="#"><img src="../icon/coffee.png"></a>
                            <p>카페<br>베이커리</p>
                            </div>
                            
                            <div class="slide">
							<a href="#"><img src="../icon/food.png"></a>
                            <p>음식</p>
                            </div>
                            
                            <div class="slide">
							<a href="#"><img src="../icon/mart.png"></a>
                            <p>편의점/마트</p>
                            </div>
                            
                            <div class="slide">
							<a href="#"><img src="../icon/pay.png"></a>
                            <p>통신</p>
                            </div>
                            
                            <div class="slide">
							<a href="#"><img src="../icon/shopping.png"></a>
                            <p>쇼핑</p>
                            </div>
                            
                            <div class="slide">
							<a href="#"><img src="../icon/question.png"></a>
                            <p>기타 사용처</p>
                            </div>
                        </div>        
                    </div> -->

					<div class="alen_list_btn2">
                        <div class="alen_list_btn2item" >
                            <div class="al_btn_txt" name="divPay" id="btnToday">당일</div>
                        </div>
                        
                        <div class="alen_list_btn2item" name="divPay" id="btnWeek">
                            <div class="al_btn_txt">일주일</div>
                        </div>
                        
                        <div class="alen_list_btn2item" name="divPay" id="btnMonth">
                            <div class="al_btn_txt">한달</div>
                        </div>
                        
                        <div class="alen_list_btn2item on" name="divPay" id="btnRefresh">
                            <div class="al_btn_txt">최근</div>
                        </div>

                        <div class="alen_list_btn2item dtl" name="divPay" id="btnDetail">
                            <div class="al_btn_txt last">상세</div>
                        </div>
                        <hr>
                    </div>
                    
                    <div class="list-block alen_list_box2 albpad">
                        <ul>
                            <li>
                                <div class="item-content hsh_input"><input type="date" name="startDate"  id="startDate"  style="font-size: small;"></div>
                                
                                <div class="hsh_and">-</div>
                                
                                <div class="item-content hsh_input"><input type="date" name="endDate"  id="endDate"  style="font-size: small;"></div>
                                <hr>
                            </li>

                        </ul>
                    </div>
                    
                    <div class="list-block alen_list_box2 albpad">
                        <ul>
                            <li>
                                <div>
                                    <div class="alen_table_quad">
                                    <label class="label-radio item-content">
                                      <input type="radio" name="sort_pay" value="ALL" checked>
                                      <div class="item-inner">
                                        <div class="item-title small-fonts">전체</div>
                                      </div>
                                    </label>
                                    </div>
                                    
                                    
                                    <div class="alen_table_quad">
                                    <label class="label-radio item-content">
                                      <input type="radio" name="sort_pay" value="CARD">
                                      <div class="item-inner">
                                        <div class="item-title small-fonts">카드</div>
                                      </div>
                                    </label>
                                    </div>
                                    
                                    
                                    <div class="alen_table_quad">
                                    <label class="label-radio item-content">
                                      <input type="radio" name="sort_pay" value="CASH">
                                      <div class="item-inner">
                                        <div class="item-title small-fonts">현금</div>
                                      </div>
                                    </label>
                                    </div>
                                    
                                    
                                    <div class="alen_table_quad alen_table_last">
                                    <label class="label-radio item-content">
                                      <input type="radio" name="sort_pay" value="ETC">
                                      <div class="item-inner">
                                        <div class="item-title small-fonts">기타</div>
                                      </div>
                                    </label>
                                    </div>
                                    <hr>
                                
                                </div>
                            </li>

                        </ul>
                    </div>
                    
                    
                    <div class="list-block alen_list_box2 albpad">
                        <ul>
                            <li>
                                <div>
                                    <div class="alen_table_quad">
                                    <label class="label-radio item-content">
                                      <input type="radio" name="sort_new" value="D2" checked>
                                      <div class="item-inner">
                                        <div class="item-title small-fonts">최신</div>
                                      </div>
                                    </label>
                                    </div>
                                    
                                    
                                    <div class="alen_table_quad">
                                    <label class="label-radio item-content">
                                      <input type="radio" name="sort_new" value="D1">
                                      <div class="item-inner">
                                        <div class="item-title small-fonts">과거</div>
                                      </div>
                                    </label>
                                    </div>
                                    
                                    
                                    <div class="alen_table_quad">
                                    <label class="label-radio item-content">
                                      <input type="radio" name="sort_new" value="A2">
                                      <div class="item-inner">
                                        <div class="item-title small-fonts">높은금액</div>
                                      </div>
                                    </label>
                                    </div>
                                    
                                    
                                    <div class="alen_table_quad alen_table_last">
                                    <label class="label-radio item-content">
                                      <input type="radio" name="sort_new" value="A1">
                                      <div class="item-inner">
                                        <div class="item-title small-fonts">낮은금액</div>
                                      </div>
                                    </label>
                                    </div>
                                    <hr>
                                
                                </div>
                            </li>

                        </ul>
	                    <div class="alen_list_combtnbox" >
	                        <div class="alen_list_combtn small-fonts" id="searchBtn" >조  회</div>
	                    </div>
                    </div>
                    
                       

                        
                                        

					<div class="latest_box alen_outbox">

                        
                    	<div class="latest_content" >
                        	<ul id="receiptData">

                            </ul>
                        </div>
                    </div>
                    
                    <div class="foot_info">
                    
<!--                     	<div class="foot_box">
                        	<div class="foot_btn alen_outbox">
                            <a href="#agree03">이용약관</a>
                            </div>
                            
                        	<div class="foot_btn alen_outbox">
                            <a href="#agree01">개인정보 취급방침</a>
                            </div>
                            
                        	<div class="foot_btn alen_outbox">
                            <a href="javascript:void(0)">고객센터</a>
                            </div>
                            
                            
                            <hr>
                        </div> -->
<p>
(주)더리얼마케팅 | 대표이사:손종희<br>
사업자등록번호:220-88-19101   |   통신판매업신고 강남 04134호<br>
서울시 강남구 압구정로10길 13, 401호(신사동, 마사빌딩)<br>
이메일 : The REAL @naver.com<br>
고객센터 : 02-518-5112 | 마케팅:02-540-3111<br>
</p>

<p class="copytxt">CopyrightⓒThe REAL Co.All rights reserved</p>
                    </div>
                    
                    
                    </div>
                </div>
                

                <div data-page="receipt_details" class="page cached">
                    <div class="page-content">
                        <div class="content-block">
                        
						<div class="receipt_box">
                        	<div class="receipt_inbox" id ="detailRecData">
                                
                            </div>
                        </div>
                        
                        <div class="latest_btnbox">
                            <div class="latest_btn" id="sendEmail">이메일 보내기</div>
                        </div>
                        
                        
                        
                        </div>
                    </div>
                </div>
                
                
                
                <div data-page="agree01" class="page cached">
                    <div class="page-content agree_acon">
                        <div class="content-block">
						<iframe src="agree01.html" frameborder="0" width="100%" height="100%"></iframe>
                        </div>
                    </div>
                </div>
                
                
                <div data-page="agree03" class="page cached">
                    <div class="page-content agree_acon">
                        <div class="content-block">
						<iframe src="agree03.html" frameborder="0" width="100%" height="100%"></iframe>
                        </div>
                    </div>
                </div>
                
                
			</div>
            
            
            
            

		</div>
    </div>
<!-- <div id="div_ajax_load_image">
    <img src="../common/log_img.png" />
</div>  -->

<script src="../js/monthpicker.min.js"></script>
<script src="../js/monthpicker-dom.min.js"></script>
<script src="../js/monthpicker.js"></script>
<script type="text/javascript" src="../js/framework7.js"></script>

<script type="text/javascript" src="../js/my-app.js"></script>

<input value="activate scrollator" id="activate_scrollator4" type="button"  style="display:none;">

<script type="text/javascript">
	var request = new Request();
	
	var dateSrchCd  = null;
	var startDate  = null;
	var endDate = null;
	var dateDivCd = null;
	var payDivCd = null;
	var orderByCd = null;	
	
	var telNo = request.getParameter('telNo');
	var uuId = request.getParameter('uuId');
	var barcodeNo = "";
	var dtlSeq = "";
	var seq = "";
	var emailSendJsonData = null;

	 function dateInput(targetday,sep){
		  
		  var date = new Date();
		  var start = new Date(Date.parse(date) - targetday * 1000 * 60 * 60 * 24);
		  
		  var yyyy = start.getFullYear();
		  var mm = start.getMonth()+1;
		  var dd = start.getDate();
		  
		  if(mm<10){
		   mm = "0" + mm;
		  }if(dd<10){
		   dd = "0" + dd;
		  }
		  
		  return yyyy + sep + mm + sep + dd; 
		  
		 }	
	
/* 	var today = new Date();
	var dd = today.getDate();
	var mm = today.getMonth()+1;
	var yyyy = today.getFullYear();

	if(dd<10) {
	    dd='0'+dd
	} 

	if(mm<10) {
	    mm='0'+mm
	}  */
    $('#startDate').val(dateInput(7,"-"));		
    $('#endDate').val(dateInput(0,"-"));
/* 	document.addEventListener("deviceready", 	function(){
		  if(device.platform.toUpperCase() == 'ANDROID'){
		    window.plugins.pushNotification.register(successHandler,errorHandler, {
		      //"senderID" : "912734728084", // Google GCM 서비스에서 생성한 Project Number를 입력한다.
		      "senderID" : "416114430430", // Google GCM 서비스에서 생성한 Project Number를 입력한다.
		      "ecb" : "onNotificationGCM" // 디바이스로 푸시가 오면 onNotificationGCM 함수를 실행할 수 있도록 ecb(event callback)에 등록한다.
		    });
		  }
		
		});	 */
	
	function latestDivSrch(dateSrchCd,startDate,endDate,dateDivCd,payDivCd,orderByCd){
     	    $.ajax({
    	        type: "post",
    	        url : commonIp()+"/theReal/receipt/latestData.do",
    	        data: {
    	        	telNo  	: telNo,
    	        	dateSrchCd : dateSrchCd, 
    	        	startDay : startDate, 
    	        	endDay : endDate,
    	        	dateDivCd : dateDivCd,
    	        	payDivCd : payDivCd,
    	        	orderByCd : orderByCd,
    	        },
    	        success: fn_latestData,
    	        error: whenError
        	});			
		}	
		
	$(document).ready(function(){

		
		$("#totalAmount").click(function(){
			location.href='household.html?telNo='+request.getParameter('telNo');
		})
		
		$("#btnDetail").click(function(){
			if($('#btnDetail').hasClass("dtl")){
				$('#btnDetail').removeClass("dtl");
				$('.alen_table_quad').css({'height': '35px'});
				$('#searchBtn').css({'line-height': '35px'});
				$(".list-block").slideDown();
				//alert($('.on').attr("id"));
			}else{
				$('#btnDetail').addClass("dtl");
				
				$(".list-block").slideUp();
			}
		})
		
		$('[name="divPay"]').click(function(){
			if($('[name="divPay"]').hasClass("on")){
				$('[name="divPay"]').removeClass("on");
				$('[name="divPay"]').css({'color': '','border': ''});
				$(this).addClass("on");
				$(this).css({'color': '#539bff'});
				//alert($('.on').attr("id"));
			}else{
				$(this).addClass("on");
				$(this).css({'color': '539bff'});
			}
		})
		//당일버튼 클릭 시
        $("#btnToday").click(function(){
        	latestDivSrch("N","N","N","TODAY","N","N");
        });
        
        //일주일 버튼 클릭 시
        $("#btnWeek").click(function(){
        	latestDivSrch("N","N","N","WEEK","N","N");
        });
        
        //한달 버튼 클릭시 
        $("#btnMonth").click(function(){
        	latestDivSrch("N","N","N","MONTH","N","N");
        });

        //새로고침 버튼 클릭시 
        $("#btnRefresh").click(function(){
        	latestData();
        });
		
    	$("#searchBtn").click(function(){
    		//시작일자
    		var startDateVal = $(':input[name="startDate"]').val();
    		//종료일자
    		var endDateVal = $(':input[name="endDate"]').val();
    		//조회내용
    		startDateComVal = replaceAll(startDateVal,"","");
    		endDateComVal = replaceAll(endDateVal,"","");
    		if(startDateComVal > endDateComVal){
    			alert("조회일자가 현재일자보다 큽니다.");
    			$(':input[name="startDate"]').focus();
    			return false;
    		}
    		var sortPayVal = $(':radio[name="sort_pay"]:checked').val();
    		//조회결과순서
    		var sortNewVal = $(':radio[name="sort_new"]:checked').val();
    		console.log(startDateVal);
    		console.log(endDateVal);
    		console.log(sortPayVal);
    		console.log(sortNewVal);
    		if(isNull(startDateVal)){
    			alert("시작일자를 입력해주시기 바랍니다.");
    			return false;
    		}
    		if(isNull(endDateVal)){
    			alert("종료일자를 입력해주시기 바랍니다.");
    			return false;
    		}
    		//$("#receiptData").empty();
    		latestDivSrch("Y",startDateVal,endDateVal,"N",sortPayVal,sortNewVal);
    	})		
		
/* 		$("#dtlSearchBtn").click(function(){
			location.href='history_search.html?uuId='+uuId+'&telNo='+telNo;
		}) */
		
		  $('.history_cate').bxSlider({
			  slideWidth: 70,
			  minSlides: 2,
			  maxSlides: 8,
			  moveSlides: 4,
			  slideMargin: 10,
			  auto: false,
			  autoHover: true,
			  pager: false,
			  controls: false
		  });		
		
		latestData();
		commonUserData();
		$(document).on('click','[name="receiptDetail"]',function(){
			seq = $(this).attr('id');
			seq = seq.replace("seq","");
			dtlSeq = seq;
			barcodeNo = $("#barcodeNo"+seq).val()
			latestDetailData(seq);
		});
		
		$(document).on('click','#sendEmail',function(){
			console.log(seq);
			callEmailSend(seq);
		});				
		
		
	})

	function replaceAll(content,before,after){
	    return content.split(before).join(after);
	}	
	
	function latestData(){
	    $.ajax({
	        type: "post",
	        url : commonIp()+"/theReal/receipt/latestData.do",
	        data: {
	        	telNo  	: telNo
	        },
	        success: fn_latestData,

	        
/* 	        beforeSend: function () {
	              var width = 0;
	              var height = 0;
	              var left = 0;
	              var top = 0;
	              width = 50;
	              height = 50;

	              top = ( $(window).height() - height ) / 2 + $(window).scrollTop();
	              left = ( $(window).width() - width ) / 2 + $(window).scrollLeft();
	 console.log($("#div_ajax_load_image").length)
	              if($("#div_ajax_load_image").length != 0) {
	                     $("#div_ajax_load_image").css({
	                            "top": "100px",
	                            "left": "100px"
	                     });
	                     $("#div_ajax_load_image").show();
	              }
	              else {
	                     $('body').append('<div id="div_ajax_load_image" style="position:absolute; top:' + top + 'px; left:' + left + 'px; width:' + width + 'px; height:' + height + 'px; z-index:9999; background:#f0f0f0; filter:alpha(opacity=50); opacity:alpha*0.5; margin:auto; padding:0; "><img src="file://D:\\temp\\ajax_loader.gif" style="width:50px; height:50px;"></div>');
	              }
	       },	 */        
	        
	        
	        error: whenError
    	});				
	};
	
	function latestDetailData(seq){
	    $.ajax({
	        type: "post",
	        url : commonIp()+"/theReal/receipt/latestDetailData.do",
	        data: {
	        	telNo  	: telNo,
	        	salesBarcode  	: barcodeNo
	        },
	        success: fn_latestDetailData,
	        error: whenError
		});				
	};
	
	function fn_latestData(resdata){
		
		var str = "";
		var resultData = resdata.resultMap;
		var cardCashDiv = "";
		
		$("#receiptData").empty();
		
		resultCnt = resultData.length;
		if(resultData.length>0){
			for(var i=0; i<resultCnt; i++){
				if(resultData[i].CARD_ICOM == ""){
					cardCashDiv = "현금"		
				}else{
					cardCashDiv = resultData[i].CARD_ICOM;	
				}
				$("#totalAmount").text("총 "+resultCnt+"건 / "+resultData[i].TOTAL_AM+"원");
				
				str += '<li style="margin: 0 0 10px 0";>';
				str += '<input type="hidden" value = "'+resultData[i].SALES_BARCODE+'" id="barcodeNo'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].SHOP_NAME+'" id="shopName'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].SHOP_ADDR+'" id="shopAddr'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].SHOP_BIZNO+'" id="shopBizNo'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].SHOP_CEO+'" id="shopCeo'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].SHOP_TEL_NUM+'" id="shopTelNum'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].SHOP_CASHIER+'" id="shopCashier'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].SALES_DATE+'" id="salesDate'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].CARD_APP_NO+'" id="cardAppNo'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].CARD_NO+'" id="cardNo'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].CARD_ICOM+'" id="cardICom'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].CARD_INSTALLMENT+'" id="cardInstall'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].EMAIL+'" id="emailInfo'+resultData[i].SEQ+'">';
				str += '<input type="hidden" value = "'+resultData[i].USER_NM+'" id="userNm'+resultData[i].SEQ+'">';
				//전체부가세합
				str += '<input type="hidden" value = "'+resultData[i].SALES_SUM_TAX_AMT+'" id="sumTaxAmt'+resultData[i].SEQ+'">';
				//면세물품가액
				str += '<input type="hidden" value = "'+resultData[i].SALES_SUM_DF_AMT+'" id="sumDfAmt'+resultData[i].SEQ+'">';
				//과세물품가액
				str += '<input type="hidden" value = "'+resultData[i].SALES_SUM_FP_AMT+'" id="sumFpAmt'+resultData[i].SEQ+'">';
				//전체판매금액
				str += '<input type="hidden" value = "'+resultData[i].SALES_SUM_AL_AMT+'" id="sumAlAmt'+resultData[i].SEQ+'">';
				//전체 결제금액
				str += '<input type="hidden" value = "'+resultData[i].SALES_PAID_AMT+'" id="sumPaidAmt'+resultData[i].SEQ+'">';
				str += '<a href="#receipt_details" name="receiptDetail" id="seq'+resultData[i].SEQ+'">';
				//str += '<a href="#" name="receiptDetail" id="seq'+i+'">';
				str += '<div class="mlat01" id="mlat01'+resultData[i].SEQ+'">'+resultData[i].SALES_PRINT_DATE+'</div>';
				str += '<div class="mlaticon" id="mlaticon'+resultData[i].SEQ+'"><span>커피</span></div>';
				str += '<div class="mlat02" id="mlat02'+resultData[i].SEQ+'">'+cardCashDiv+'</div>';
				str += '<div class="mlat03" id="mlat03'+resultData[i].SEQ+'">'+resultData[i].SHOP_NAME+'</div>';
				str += '<div class="mlat04" id="mlat04'+resultData[i].SEQ+'">'+numberWithCommas(resultData[i].SALES_SUM_AL_AMT)+'</div>';
				
				str += '<hr>';		            
				str += '</a>';		            
				str += '</li>';		            
			}
		}else{
			str += '<li>';
			str += '<div style="width: 50%;margin-left: 25%";><img style="width: 80%;" src="../common/emptyList03.jpg"></div>';			
			str += '</li>';		
			$("#totalAmount").text("총 0건 / 0원");
		}
		$("#receiptData").append(str);		
		//$("#detailRecData").empty();
		
	};
	
	function fn_latestDetailData(resdata){
		var str = "";
		var resultData = resdata.resultMap;
		var cardCashDtlDiv = "";
		
		$("#detailRecData").empty();
		resultCnt = resultData.length;
		
		if(resultData.length>0){
			str += ' <div class="receipt_holl">	';
			str += ' 	<div></div>             ';
			str += '     <div></div>             ';
			str += '     <div></div>             ';
			str += '     <div></div>             ';
			str += '     <div></div>             ';
			str += '     <div></div>             ';
			str += '     <div></div>             ';
			str += '     <div></div>             ';
			str += '     <div></div>             ';
			str += '     <div></div>             ';
			str += '     <hr>                    ';
			str += ' </div>					    ';
			var recEmailSendObj = new Object();
			recEmailSendObj.emailInfo = $("#emailInfo"+dtlSeq).val();
			recEmailSendObj.userInfo = $("#userNm"+dtlSeq).val();
			var cashDivObj = new Object();
			var cardDivObj = new Object();
			console.log($("#mlat02"+dtlSeq).text());
			if($("#mlat02"+dtlSeq).text() == "현금"){
				cardCashDtlDiv = "현금";
				str += '<div class="rec_half">';
				str += '	<ul>';
				str += '      <li><div>거래종류</div><div class="rec_hcon">'+cardCashDtlDiv+'</div></li>';
				str += '      <li><div>거래일자</div><div class="rec_hcon">'+$("#mlat01"+dtlSeq).text()+'</div></li>';
				str += '      <hr>';
				str += '    </ul>';
				str += '</div>';			
				cashDivObj.cardCashDtlDiv = cardCashDtlDiv;
				cashDivObj.cardCashRegDate = $("#mlat01"+dtlSeq).text();
			}else{
				str += '<div class="rec_txt01"><span>카드종류 : </span>'+	$("#cardICom"+dtlSeq).val()+'</div>';
				str += '<div class="rec_txt01"><span>카드번호 : </span>'+	$("#cardNo"+dtlSeq).val()+'</div>';		
				cardCashDtlDiv = "신용결제";
				str += '<div class="rec_half">';
				str += '	<ul>';
				str += '      <li><div>거래종류</div><div class="rec_hcon">'+cardCashDtlDiv+'</div></li>';
				str += '      <li><div>거래일자</div><div class="rec_hcon">'+$("#mlat01"+dtlSeq).text()+'</div></li>';
				str += '      <li><div>승인번호</div><div class="rec_hcon">'+	$("#cardAppNo"+dtlSeq).val()+'</div></li>';
				str += '      <li><div>할부개월수</div><div class="rec_hcon">'+	$("#cardInstall"+dtlSeq).val()+'</div></li>';
				str += '      <hr>';
				str += '    </ul>';
				str += '</div>';			
				cardDivObj.cardICom = $("#cardICom"+dtlSeq).val();
				cardDivObj.cardNo = $("#cardNo"+dtlSeq).val();				
				cardDivObj.cardCashDtlDiv = cardCashDtlDiv;				
				cashDivObj.cardRegDate = $("#mlat01"+dtlSeq).text();
				cardDivObj.cardAppNo = $("#cardAppNo"+dtlSeq).val();				
				cardDivObj.cardInstall = $("#cardInstall"+dtlSeq).val();				
				
			}
			
			//str += '<div class="rec_date"><span id = "recDate">'+$("#mlat01"+dtlSeq).text()+'</span> <span class="rec_right" id="recRight">'+barcodeNo+'</span><hr></div>';
			str += '<div class="rec_table">';
			str += '<ul class="rec_tabletitle">';
			str += '<li class="rec_mlat01">상품명</li>';
			str += '<li class="rec_mlat02">단가</li>';
			str += '<li class="rec_mlat03">수량</li>';
			str += '<li class="rec_mlat04">금액</li>';
			str += '<hr>';
			str += '</ul>';		

			var dtlGoodsArr = new Array();
			for(var i=0; i<resultCnt; i++){
	            str += '<ul>';
	            str += '  <li class="rec_mlat01" id="dtlGoods'+i+'">'+resultData[i].SALES_PNAME+'</li>';
	            str += '  <li class="rec_mlat02" id="dtlPPrice'+i+'">'+numberWithCommas(resultData[i].SALES_PPRICE)+'</li>';
	            str += '  <li class="rec_mlat03" id="dtlQty'+i+'">'+resultData[i].SALES_QTY+'</li>';
	            str += '  <li class="rec_mlat04" id="dtlSlAmt'+i+'">'+numberWithCommas(resultData[i].SALES_SL_AMT)+'</li>';
	            str += '  <hr>';
	            str += '</ul>';				
				var dtlGoodsObj = new Object();			
	            dtlGoodsObj.dtlGoods = resultData[i].SALES_PNAME;
	            dtlGoodsObj.dtlPPrice = numberWithCommas(resultData[i].SALES_PPRICE);
	            dtlGoodsObj.dtlQty = resultData[i].SALES_QTY;
	            dtlGoodsObj.dtlSlAmt =numberWithCommas(resultData[i].SALES_SL_AMT);
	            dtlGoodsArr.push(dtlGoodsObj);
			}
			str += '</div>';

			str += '<div class="rec_half">';
			str += '	<ul>';
			str += '      <li><div>공급금액</div><div class="rec_hcon">'+numberWithCommas($("#sumFpAmt"+dtlSeq).val())+'</div></li>';
			str += '      <li><div>부 가 세</div><div class="rec_hcon">'+numberWithCommas($("#sumTaxAmt"+dtlSeq).val())+'</div></li>';
			str += '      <li><div>합계금액</div><div class="rec_hcon">'+numberWithCommas($("#sumPaidAmt"+dtlSeq).val())+'</div></li>';
			str += '      <li><div>반환금액</div><div class="rec_hcon">'+($("#sumPaidAmt"+dtlSeq).val()-$("#sumAlAmt"+dtlSeq).val())+'</div></li>';
/* 			str += '      <li><div>부가세</div><div class="rec_hcon">'+numberWithCommas($("#sumTaxAmt"+dtlSeq).val())+'</div></li>';
			str += '      <li><div>합 계</div><div class="rec_hcon">'+numberWithCommas($("#sumAlAmt"+dtlSeq).val())+'</div></li>';
			str += '      <li><div>결제금액</div><div class="rec_hcon">'+numberWithCommas($("#sumPaidAmt"+dtlSeq).val())+'</div></li>';
			str += '      <li><div>반환금액</div><div class="rec_hcon">'+($("#sumPaidAmt"+dtlSeq).val()-$("#sumAlAmt"+dtlSeq).val())+'</div></li>'; */
			str += '      <hr>';
			str += '    </ul>';
			str += '</div>';
			str += '<div class="rec_half">';
			str += '	<ul>';
			str += '      <li><div>업체명</div><div class="rec_hcon">'+$("#shopName"+dtlSeq).val()+'</div></li>';
			str += '      <li><div>대표자</div><div class="rec_hcon">'+$("#shopCeo"+dtlSeq).val()+'</div></li>';
			str += '      <li class="rec_full"><div>가맹점주소</div><div class="rec_hcon">'+$("#shopAddr"+dtlSeq).val()+'</div></li>';
			str += '      <li class="rec_full"><div>문의연락처</div><div class="rec_hcon">'+$("#shopTelNum"+dtlSeq).val()+'</div></li>';
			str += '      <li class="rec_full"><div>사업자번호</div><div class="rec_hcon">'+$("#shopBizNo"+dtlSeq).val()+'</div></li>';
			str += '      <hr>';
			str += '    </ul>';
			str += '</div>';			
			
			var dtlInfoObj = new Object();
			dtlInfoObj.sumTaxAmt = numberWithCommas($("#sumTaxAmt"+dtlSeq).val());
			dtlInfoObj.sumAlAmt = numberWithCommas($("#sumAlAmt"+dtlSeq).val());
			dtlInfoObj.sumPaidAmt = numberWithCommas($("#sumPaidAmt"+dtlSeq).val());
			dtlInfoObj.sumChargeAmt = ($("#sumPaidAmt"+dtlSeq).val()-$("#sumAlAmt"+dtlSeq).val());
			dtlInfoObj.shopName = $("#shopName"+dtlSeq).val();
			dtlInfoObj.shopCeo = $("#shopCeo"+dtlSeq).val();
			dtlInfoObj.shopAddr = $("#shopAddr"+dtlSeq).val();
			dtlInfoObj.shopTelNum = $("#shopTelNum"+dtlSeq).val();
			dtlInfoObj.shopBizNo = $("#shopBizNo"+dtlSeq).val();
/* 			str += '<div class="rec_table2">';
			str += '	<ul>';
			str += '    	<li class="rec_mlat05">면세물품가액</li>';
			str += '    	<li class="rec_mlat06">'+numberWithCommas($("#sumDfAmt"+dtlSeq).val())+'</li>';
			str += '        <hr>';
			str += '    </ul>';
			str += '	<ul>';
			str += '    	<li class="rec_mlat05">과세물품가액</li>';
			str += '    	<li class="rec_mlat06">'+numberWithCommas($("#sumFpAmt"+dtlSeq).val())+'</li>';
			str += '        <hr>';
			str += '    </ul>';
			str += '	<ul>';
			str += '    	<li class="rec_mlat05">부가세</li>';
			str += '    	<li class="rec_mlat06">'+numberWithCommas($("#sumTaxAmt"+dtlSeq).val())+'</li>';
			str += '        <hr>';
			str += '    </ul>';
			str += '</div>';
			str += '<div class="rec_table3">';
			str += '	<ul>';
			str += '    	<li class="rec_mlat07">합 계</li>';
			str += '    	<li class="rec_mlat08">'+numberWithCommas($("#sumAlAmt"+dtlSeq).val())+'</li>';
			str += '        <hr>';
			str += '    </ul>';
			str += '	<ul>';
			str += '    	<li class="rec_mlat07">결제금액</li>';
			str += '    	<li class="rec_mlat08">'+numberWithCommas($("#sumPaidAmt"+dtlSeq).val())+'</li>';
			str += '        <hr>';
			str += '    </ul>';
 			str += '	<ul>';
			str += '    	<li class="rec_mlat07">반환금액</li>';
			str += '    	<li class="rec_mlat08">'+($("#sumPaidAmt"+dtlSeq).val())+'</li>';
			str += '        <hr>';
			str += '    </ul>'; 
			str += '</div>';	 */	
		}
		$("#detailRecData").append(str);		
		recEmailSendObj.cashDivObj =cashDivObj;
		recEmailSendObj.cardDivObj =cardDivObj;
		recEmailSendObj.dtlInfoObj =dtlInfoObj;
		recEmailSendObj.dtlGoodsArr =dtlGoodsArr;

		emailSendJsonData = JSON.stringify(recEmailSendObj);
		//console.log(emailSendJsonData);
		//alert(emailSendJsonData);
	};
	
	
	function fn_latestUpdateData(){
		console.log("확인여부업데이트");
	};
	
	function whenError(){
		alert("실패");
	};
	
	/**
	 * onNotificationGCM
	 *
	 * @param e
	 *
	 * 안드로이드 디바이스로 푸시 메세지를 받을 때 호출되는 함수, window.plugins.pushNotification.register 옵션에 설정에서 ecb의 이름에 매칭된다.
	 */
	function onNotificationGCM (e){
	  switch (e.event) {
	  case 'registered': // 안드로이드 디바이스의 registerID를 획득하는 event 중 registerd 일 경우 호출된다.
	    console.log('registerID:' + e.regid);
	    break;
	  case 'message': // 안드로이드 디바이스에 푸시 메세지가 오면 호출된다.
	    {
	        console.log(':' + e);
	      if (e.foreground){ // 푸시 메세지가 왔을 때 앱이 실행되고 있을 경우
	        var soundfile = e.soundname || e.payload.sound;
	        var my_media = new Media("/android_asset/www/" + soundfile);
	        my_media.play();
	        
	        navigator.notification.alert(
	      		  decodeURI(e.payload.message),  // message
	      		    function(){
		      			latestData();
		      			commonUserData();	      		 
	      			},         // callback	      		  
	      		    decodeURI(e.payload.title),            // title
	      		    '확인'                  // buttonName
	      		);            
	        
	      } else { // 푸시 메세지가 왔을 때 앱이 백그라운드로 실행되거나 실행되지 않을 경우
	        if (e.coldstart) { // 푸시 메세지가 왔을 때 푸시를 선택하여 앱이 열렸을 경우
	          console.log("알림 왔을 때 앱이 열리고 난 다음에 실행 될때");
	        } else { // 푸시 메세지가 왔을 때 앱이 백그라운드로 사용되고 있을 경우
	          console.log("앱이 백그라운드로 실행될 때");
	        }
	      }

	      console.log(decodeURI(e.payload.title));
	      console.log(decodeURI(e.payload.message));
	      //navigator.notification.alert(decodeURI(e.payload.msg));
	      
	    }
	    break;
	  case 'error': // 푸시 메세지 처리에 에러가 발생하면 호출한다.
	    console.log('error:' + e.msg);
	    break;
	  case 'default':
	    console.log('알수 없는 이벤트');
	    break;
	  }
	}	

	function callEmailSend(seq){
	    $.ajax({
	     type: "post",
	     url : commonIp()+"/theReal/receipt/sendMail.do",
	     data: {
	    	 emailSendJsonData : emailSendJsonData
	     },
	     success: callEmailSendSuc,
	     error: whenError
	 	});
	}	
	
	function callEmailSendSuc(resdata){
		alert("완료");
	}	
	
</script>


</body>
</html>
